<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Beginner&#x27;s CTF Handbook</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="index.html">Introduction</a></li><li class="chapter-item "><a href="tools/tools.html"><strong aria-hidden="true">1.</strong> Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/vms.html"><strong aria-hidden="true">1.1.</strong> Virtual Machines</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/hypervisors.html"><strong aria-hidden="true">1.1.1.</strong> Hypervisors</a></li><li class="chapter-item "><a href="tools/vm-snapshots.html"><strong aria-hidden="true">1.1.2.</strong> Snapshots</a></li><li class="chapter-item "><a href="tools/vm-shared.html"><strong aria-hidden="true">1.1.3.</strong> Shared Files on VMware</a></li></ol></li><li class="chapter-item "><a href="tools/kali.html"><strong aria-hidden="true">1.2.</strong> Kali Linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/kali-hyperv.html"><strong aria-hidden="true">1.2.1.</strong> Kali on Hyper-V</a></li><li class="chapter-item "><a href="tools/kali-tweaks.html"><strong aria-hidden="true">1.2.2.</strong> kali-tweaks</a></li><li class="chapter-item "><a href="tools/openssh.html"><strong aria-hidden="true">1.2.3.</strong> SSH into Kali</a></li></ol></li><li class="chapter-item "><a href="tools/winbox.html"><strong aria-hidden="true">1.3.</strong> Quick Windows Box</a></li><li class="chapter-item "><a href="tools/ghidra.html"><strong aria-hidden="true">1.4.</strong> Ghidra</a></li><li class="chapter-item "><a href="tools/cyberchefintro.html"><strong aria-hidden="true">1.5.</strong> Cyberchef</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="tools/cyberchef.html"><strong aria-hidden="true">1.5.1.</strong> Cyberchef example 1</a></li><li class="chapter-item "><a href="tools/cyberchef2.html"><strong aria-hidden="true">1.5.2.</strong> Cyberchef example 2</a></li></ol></li><li class="chapter-item "><a href="Python/python.html"><strong aria-hidden="true">1.6.</strong> Python</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Python/interactive.html"><strong aria-hidden="true">1.6.1.</strong> Interactive Python</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="Python/extendingcolab.html"><strong aria-hidden="true">1.6.1.1.</strong> Extending Colab</a></li></ol></li><li class="chapter-item "><a href="Python/pythonwebserver.html"><strong aria-hidden="true">1.6.2.</strong> Quick Webserver</a></li></ol></li><li class="chapter-item "><a href="tools/vpns.html"><strong aria-hidden="true">1.7.</strong> VPNs</a></li></ol></li><li class="chapter-item "><a href="fundamentals/fundamentals.html"><strong aria-hidden="true">2.</strong> Fundamentals</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="fundamentals/charencoding.html"><strong aria-hidden="true">2.1.</strong> Character Encoding</a></li><li class="chapter-item "><a href="fundamentals/base64.html"><strong aria-hidden="true">2.2.</strong> Base64 Encoding</a></li><li class="chapter-item "><a href="fundamentals/endianness.html"><strong aria-hidden="true">2.3.</strong> Endianness</a></li><li class="chapter-item "><a href="Python/bytes.html"><strong aria-hidden="true">2.4.</strong> Handling bytes in Python</a></li><li class="chapter-item "><a href="Python/pythonxor.html"><strong aria-hidden="true">2.5.</strong> Python XOR</a></li></ol></li><li class="chapter-item "><a href="passwords/passwords-intro.html"><strong aria-hidden="true">3.</strong> Passwords</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="passwords/cracking.html"><strong aria-hidden="true">3.1.</strong> Password cracking</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Beginner&#x27;s CTF Handbook</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="welcome-to-the-capture-the-flag-class"><a class="header" href="#welcome-to-the-capture-the-flag-class">Welcome to the Capture the Flag class!</a></h1>
<h2 id="dave-henthorn-rose-hulman-institute-of-technology"><a class="header" href="#dave-henthorn-rose-hulman-institute-of-technology">Dave Henthorn, Rose-Hulman Institute of Technology.</a></h2>
<img src="keypadlock.png" alt="Course Banner Image">
<p>In this course, we're going to learn some of the basic tactics, techniques, and procedures associated with solving CTF challenges. Along the way, I hope you will pick up on some key cybersecurity basics.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ctf-tools"><a class="header" href="#ctf-tools">CTF Tools</a></h1>
<p>Here's a list of tools that we will use in this course.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="virtual-machines"><a class="header" href="#virtual-machines">Virtual Machines</a></h1>
<p>Many of us run our CTF/penetration testing tools inside a <em>virtual</em> machine instead of on our desktop. </p>
<p>This helps because we can:</p>
<ul>
<li>keep our own machines free of extraneous tools</li>
<li>protect our machines from software of unknown origin</li>
<li>run tools that are not native to our default OS</li>
</ul>
<p>Before you can run a virtual machine (the guest), you need to set up the host machine as a hypervisor.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hypervisors"><a class="header" href="#hypervisors">Hypervisors</a></h1>
<p>Hypervisors are the software piece that manage virtual machines and allow them access to your hardware. The most common hypervisors for penetration testing or CTF competitions are:</p>
<ul>
<li>VMware</li>
<li>VirtualBox</li>
<li>Hyper-V</li>
<li>KVM / QEMU</li>
</ul>
<p>I find hypervisors to be a matter of personal preference -- each has a set of pros/cons. Some thoughts:</p>
<h2 id="vmware"><a class="header" href="#vmware">VMware:</a></h2>
<ul>
<li>The flagship VMware hypervisors are run on the largest servers in the world and are hugely expensive and immensely capable. The company provides some of this functionality in desktop versions, VMware Player (Intel/AMD) and VMware Fusion (Mac). While these cost money, they provide them free for non-commercial and academic use. These are my personal choice. High quality networking options, display tuning, snapshots, etc. Fusion (Mac) can be found <a href="https://www.vmware.com/products/fusion/fusion-evaluation.html">here</a> while Player (Intel/AMD) is <a href="https://www.vmware.com/content/vmware/vmware-published-sites/us/products/workstation-player/workstation-player-evaluation.html.html">here</a>.</li>
</ul>
<h2 id="virtualbox"><a class="header" href="#virtualbox">VirtualBox</a></h2>
<ul>
<li>Available <a href="https://www.virtualbox.org/">here</a> Sort of the opposite of VMware... much of it is open source (GPLv2 license) and free. Very popular for hackers because of this. I wish it had better documentation and advanced networking support, but you can't beat the price.</li>
</ul>
<h2 id="hyper-v"><a class="header" href="#hyper-v">Hyper-V</a></h2>
<ul>
<li>Developed by Microsoft and available as a built-in service in many versions of Windows, this is an easy one to use for many people. Growing in popularity every year. Learn how to enable Hyper-V <a href="https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v">here</a>. With some configuration tweaks you can use Enhanced Session Mode which enables a better graphical experience along with a working clipboard, complete with file transfer.</li>
</ul>
<h2 id="kvmqemu"><a class="header" href="#kvmqemu">KVM/QEMU</a></h2>
<ul>
<li>Great choice if you are on a Linux distro. Instructions for enabling on Debian distros <a href="https://wiki.debian.org/KVM">here</a>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vm-snapshots"><a class="header" href="#vm-snapshots">VM Snapshots</a></h1>
<p>One of the coolest features of VMs is the ability to take &quot;snapshots&quot;. You are, in essence, saving the state of a VM at that instant in time. You can then roll back changes to a previous known state whenever needed.</p>
<p>For CTF competitions, a workflow I see quite a bit is:</p>
<ol>
<li>Create a VM and tweak with all the tools you will need.</li>
<li>Snapshot the VM.</li>
<li>Start a challenge. This may require you to install new software, add new packages to Python, add temporary entries to /etc/hosts, download binaries for reverse engineering, etc.</li>
<li>Complete the challenge.</li>
<li>Rollback the VM to the pre-challenge snapshot. On to the next challenge!</li>
</ol>
<p>On Hyper-V, snapshots are known as <strong>Checkpoints</strong>.</p>
<p>On Hyper-V Manager, right click your VM and select Checkpoint.
<img src="tools/checkpoint.png" alt="Checkpointing Image" /></p>
<p>You will thank yourself later if you rename the checkpoint to something more descriptive.</p>
<p><img src="tools/checkpoint2.png" alt="Checkpointing Image" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-a-shared-file-space-between-your-host-and-guest-vm"><a class="header" href="#creating-a-shared-file-space-between-your-host-and-guest-vm">Creating a shared file space between your host and guest (VM).</a></h1>
<h2 id="warning-one-of-the-main-reasons-we-run-vms-is-to-create-isolation-between-our-work-machine-and-potentially-malicious-code-think-hard-about-the-implications-of-allowing-a-guest-vm-access-to-some-of-your-files"><a class="header" href="#warning-one-of-the-main-reasons-we-run-vms-is-to-create-isolation-between-our-work-machine-and-potentially-malicious-code-think-hard-about-the-implications-of-allowing-a-guest-vm-access-to-some-of-your-files">Warning: One of the main reasons we run VMs is to create isolation between our work machine and potentially malicious code. Think hard about the implications of allowing a guest VM access to some of your files.</a></h2>
<p>To create a shared file space between your host and VM, you can use the Settings area of VMware Player and select &quot;Shared Folders&quot;.</p>
<p><img src="tools/vmware-shared.png" alt="image that shows vmware shared folder settings" /></p>
<p>On your Kali VM, complete the following:</p>
<pre><code>sudo mkdir /mnt/shared
</code></pre>
<pre><code>sudo /usr/bin/vmhgfs-fuse .host:/shared /mnt/shared -o subtype=vmhgfs-fuse,allow_other
</code></pre>
<p>Tweak the line above if you named your share something other than <code>shared</code>. A shared file space is now available at /mnt/shared on your VM.</p>
<p>On Windows:</p>
<p><img src="tools/vmshared-win.png" alt="Windows file explorer screenshot" /></p>
<p>On Kali:</p>
<p><img src="tools/vmshared-kali.png" alt="Windows file explorer screenshot" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kali-linux"><a class="header" href="#kali-linux">Kali Linux</a></h1>
<p>The most famous distribution of Linux used by hackers worldwide. The main website is <a href="https://www.kali.org/">here</a>.</p>
<p>Note that Kali is based on Debian Linux so you can find tips on setup, package management, etc. by searching for Kali, Debian, or even Ubuntu.</p>
<p>From the Kali website:</p>
<p><code>The Kali Linux distribution is based on Debian Testing. Therefore, most of the Kali packages are imported, as-is, from the Debian repositories. In some cases, newer packages may be imported from Debian Unstable or Debian Experimental, either to improve user experience, or to incorporate needed bug fixes.</code></p>
<p>I prefer create a VM from scratch using an ISO from <a href="https://www.kali.org/get-kali/#kali-installer-images">here</a>.</p>
<p>If you have a working hypervisor and are on PC, you can also grab a pre-built VM image from <a href="https://www.kali.org/get-kali/#kali-virtual-machines">here</a></p>
<p>As of August 2023, the most recent version is 2023.3</p>
<p><img src="tools/banner-2023.3-release.jpg" alt="Kali Linux release banner" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-kali-linux-on-hyper-v"><a class="header" href="#installing-kali-linux-on-hyper-v">Installing Kali Linux on Hyper-V</a></h1>
<p>For this class I would like us to use Hyper-V as our hypervisor of choice. We will be working with the following:</p>
<ul>
<li>Kali under Hyper-V with Enhanced Session Mode</li>
<li>Windows Dev images for some proof-of-concept work. Info <a href="https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/">here.</a></li>
<li>Windows Sandbox mode <a href="https://learn.microsoft.com/en-us/windows/security/application-security/application-isolation/windows-sandbox/windows-sandbox-overview">Link to Sandbox mode.</a></li>
</ul>
<p>Contact me if you are planning to use a Mac or Linux laptop for this course. </p>
<p>Ready to install Kali on Hyper-V? Follow these instructions:</p>
<ol>
<li>Enable Hyper-V if you haven't already. Instructions are <a href="https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v">here</a>.</li>
<li>Enable Enhanced Session Mode in Hyper-V. Follow <a href="https://learn.microsoft.com/en-us/windows-server/virtualization/hyper-v/learn-more/use-local-resources-on-hyper-v-virtual-machine-with-vmconnect">this guide</a> for instructions.</li>
<li>Download an installation ISO (not pre-built VM) from <a href="https://www.kali.org/get-kali/#kali-installer-images">here</a>.</li>
<li>Set up a Hyper-V VM for a Kali install. Check out this guide <a href="https://www.kali.org/docs/virtualization/install-hyper-v-guest-vm/">here</a>.</li>
<li>Install Kali into the new VM. Instructions <a href="https://www.kali.org/docs/installation/hard-disk-install/">here</a>.</li>
<li>Follow <a href="https://www.kali.org/docs/virtualization/install-hyper-v-guest-enhanced-session-mode/">these instructions</a> on how to make Enhanced Session Mode active. This will allow you to use the clipboard effectively.</li>
<li>Use your newly found Copy/Paste abilities to transfer a new desktop wallpaper to your Kali instance, for example from <a href="https://github.com/dorianpro/kali-linux-wallpapers">here</a>.</li>
</ol>
<p>At this point, you should have Kali in a beautifully rendered screen with a functioning clipboard. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kali-tweaks"><a class="header" href="#kali-tweaks">kali-tweaks</a></h1>
<p>Be sure to check out the <code>kali-tweaks</code> command. You will find some nice customization options here.</p>
<p><img src="tools/kali-tweaks.png" alt="kali-tweaks menu" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssh-into-kali"><a class="header" href="#ssh-into-kali">SSH into Kali</a></h1>
<p>Since many of the tools you will use on Kali are command line, you don't always need to use the graphical user interface. Sometimes it's easiest to use a terminal and SSH into your Kali instance.</p>
<p>Out of the box, SSH connections to your Kali box are disabled. To enable them, complete the following on your VM:</p>
<p>Install the OpenSSH server.</p>
<pre><code>sudo apt install openssh-server
</code></pre>
<p>Enable the SSH service.</p>
<pre><code>sudo systemctl enable ssh.service 
</code></pre>
<p>Now start the SSH service.</p>
<pre><code>sudo systemctl start ssh.service
</code></pre>
<p>Finally, record the IP address of your box -- usually located at eth0 for a VM with one network interface.</p>
<pre><code>ip a
</code></pre>
<p><img src="tools/ipaddr.png" alt="image" /></p>
<p>In the above case, the address of your VM is <code>192.168.46.91</code> and your username is <code>kali</code>. </p>
<p>You should be able to login from your desktop now using:</p>
<pre><code>ssh kali@192.168.46.9
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="creating-a-quick-windows-machine-for-analysis-work"><a class="header" href="#creating-a-quick-windows-machine-for-analysis-work">Creating a quick Windows Machine for Analysis Work</a></h1>
<p>Sometimes you need to create a quick Windows VM for analysis work. Here's one way:</p>
<p>In Hyper-V, select <strong>Quick Create</strong> from the <strong>Actions</strong> panel. </p>
<p><img src="tools/winbox.png" alt="Hyper-V " /></p>
<p>Then select the <strong>Windows 11 dev environment</strong>. This will create a Windows VM that is ready to go. The best part? All of the Windows stuff (Xbox Live, OneDrive, etc.) that requires you to sign in with an account has been disabled.</p>
<p><img src="tools/winbox2.png" alt="Hyper-V " /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ghidra"><a class="header" href="#ghidra">Ghidra</a></h1>
<p>Ghidra is an open source tool from the National Security Agency (yes, that NSA!) that we use for reverse engineering.</p>
<p>Ghidra is a Java app, so you need a working JDK before you can run it. </p>
<ol>
<li>
<p>On a Linux machine, you can check your Java version with:</p>
<pre><code>java -version
</code></pre>
</li>
<li>
<p>Look for the version output, something like:
<code>openjdk version &quot;17.0.8&quot; 2023-07-18</code>
Be sure that you have version 17 or higher. </p>
</li>
<li>
<p>If you need to install Java, you can use the following command on Kali Linux.</p>
<pre><code>sudo apt install default-jdk
</code></pre>
</li>
<li>
<p>After you <a href="https://ghidra-sre.org/">download Ghidra</a>, there isn't a traditional installer. Instead, do the following:</p>
<ul>
<li>
<p>Unzip the file. In the unzipped archive, you will find a script to start Ghidra.</p>
<ul>
<li>On UNIX-like systems, run the file </li>
</ul>
<pre><code>./ghidraRun
</code></pre>
<ul>
<li>On Windows, run the file:</li>
</ul>
<pre><code>ghidraRun.bat
</code></pre>
</li>
</ul>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cyberchef"><a class="header" href="#cyberchef">Cyberchef</a></h1>
<p>Cyberchef is a tool put out by the GCHQ which is &quot;the UK's intelligence, security and cyber agency&quot;. It's a webapp that aims to be your go-to tool for hacking data manipulation.</p>
<p>You can find it on the web <a href="https://gchq.github.io/CyberChef/">here</a> or inside many infosec packages like Security Onion. </p>
<p><img src="tools/cyberchef1.png" alt="Starting image of Cyberchef" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cyberchef-example"><a class="header" href="#cyberchef-example">Cyberchef Example</a></h1>
<p>Here's an example:</p>
<p><img src="tools/cyberchef1.png" alt="beginning screen of cyberchef" /></p>
<p>On the left you will find a palette with all the different operations possible. You will drag those onto the <strong>Recipe</strong> panel and that will operate on the <strong>Input</strong>, producing your <strong>Output</strong>.</p>
<p>For example, let's say we have the bytes:</p>
<pre><code>\x43\x79\x62\x65\x72\x63\x68\x65\x66\x20\x69\x73\x20\x61\x77\x65\x73\x6f\x6d\x65
</code></pre>
<p>Go ahead and copy those bytes into the <strong>Input</strong> panel of Cyberchef.</p>
<p><img src="tools/cyberchef2.png" alt="input section of cyberchef" /></p>
<p>Now go over to the left-most palette and search for <strong>hex</strong> since these look like hexadecimal bytes.</p>
<p>Select <strong>From Hex</strong> and drag it on to the <strong>Recipe</strong> panel.</p>
<p><img src="tools/cyberchef3.png" alt="recipe section of cyberchef" /></p>
<p>This was a super easy one to solve.</p>
<p><img src="tools/cyberchef4.png" alt="cyberchef" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="building-recipes-in-cyberchef"><a class="header" href="#building-recipes-in-cyberchef">Building recipes in Cyberchef</a></h1>
<p>Let's say we find the following message when reverse engineering a binary.</p>
<pre><code>ttmq3a2X8YKp2qmDp8Kr2avPu4O9wrOCqcyqzraSqJCR45zsk8qK7urJqQ==
</code></pre>
<p>We know from inspecting the executable there is an XOR binary operation to obfuscate the text. But our keen eyes notice this is a Base64 encoded string. </p>
<p>Build a recipe that:</p>
<ol>
<li>Decodes the Base64 encoded string.</li>
<li>Decrypts that string using XOR decryption. Unfortunately we only know that the key used for encryption is 2 bytes in size. You will need to brute force it. HINT: We believe it is an <code>http</code> string.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python"><a class="header" href="#python">Python</a></h1>
<p>Python is a great tool for ethical hacking! It's ubiquitous, easy to work with, and you can write up a script quickly.</p>
<p>Check out the next few sections for interesting things you can do with Python.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interactive-python"><a class="header" href="#interactive-python">Interactive Python</a></h1>
<p>While many courses teach you to write Python scripts, don't forget that you can work with Python in an interactive manner. This can be done on the command line or through what is called an interactive Python notebook (.ipynb file extension).</p>
<p>My preferred method for quick work in Python is <a href="https://colab.research.google.com">Google Colab</a>, which is free with a Google account.</p>
<p>Open a <em>New notebook</em> from the <strong>File</strong> menu:</p>
<p><img src="Python/welcomecolab.png" alt="Google Colab example image" /></p>
<p>There's nothing to configure or do... just start typing your code in the code block.</p>
<p><img src="Python/colab1.png" alt="Google Colab example image" /></p>
<p>And then click the play button to execute that code block. A green checkmark shows that it executed properly.</p>
<p><img src="Python/colab2.png" alt="Google Colab example image" /></p>
<p>On the left side, you will see a toolbar. If you select the {x} button it will pull up the <em>Variable inspector</em> and you can see defined variables and their values.</p>
<p><img src="Python/colab3.png" alt="Google Colab example image" /></p>
<p><strong>IMPORTANT</strong> This is Python running in the cloud. When you are done with this instance it will be wiped and given to someone else. As such, be sure to save your data. Your work, however, is continuously being saved by Colab. If you look at the <em>File</em> menu, you will also see options for saving your notebook in Google Drive or Github, or you can download it to your host.</p>
<p>You can pull files into your Python script from your Google drive or, more easily, by clicking on the folder icon on the left. Use the upload button or simply drag files into this mini file manager.</p>
<p><img src="Python/colabfiles1.png" alt="Google Colab example image" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="extending-colab"><a class="header" href="#extending-colab">Extending Colab</a></h1>
<p>Let's say I want to use a library that is not pre-installed on Colab. For example, I want to use the pwntools library to help with a binary CTF challenge. But I run into this issue when I try the import:</p>
<p><img src="Python/colabimportfail.png" alt="colab failed import" /></p>
<p>You can install pip packages by using the following command:</p>
<pre><code>!pip install -q package_name
</code></pre>
<p>where the -q option means a quiet install.</p>
<p>And there we go! Package is now installed and my Colab instance is that much more powerful!</p>
<p><img src="Python/colabimportfail2.png" alt="colab failed import" /></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ultra-simple-web-file-sharing-using-python"><a class="header" href="#ultra-simple-web-file-sharing-using-python">Ultra simple web file sharing using Python</a></h1>
<p>Need to share files quickly? Python has your back.</p>
<p>Navigate to the folder where your file, called <code>filename</code> is located. Note the IP address of the computer and then run:</p>
<pre><code>python -m http.server 9999
</code></pre>
<p>This will create an http instance at port 9999 capable of serving files located in that directory.</p>
<p>From a different machine, connect to it through a browser or simply use wget.</p>
<pre><code>wget x.x.x.x:9999/filename
</code></pre>
<p>where x.x.x.x is the IP address of your HTTP server.</p>
<p>Note: This is an unencrypted HTTP stream. Be cognizant of the files you transfer over this stream as they will be readily visible.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vpns"><a class="header" href="#vpns">VPNs</a></h1>
<p>Let's lay out the following scenario:</p>
<p>You have been given permission to assess a specific asset for vulnerabilities, and this asset is connected to the internet. You scan the asset for open ports and find a web server running on port 80. You fire up <a href="https://github.com/OJ/gobuster">gobuster</a> to identify potential endpoints on the web site.</p>
<p><em>WARNING: Network traffic of this sort is associated with threat actors. There is a real possibility that your employer or ISP will flag your activities as malicious and take action.</em></p>
<p>To remedy this, most CTFs labs and cyber ranges will house their vulnerable assets on internal, protected networks. Your network traffic is tunneled through a Virtual Private Network (VPN) while traversing the open internet, only emerging on that protected network. Not only are the vulnerable assets protected, your malicious looking traffic is obscured from the public internet.</p>
<p>In Kali Linux, you can establish VPN connections at the top right hand corner of the screen.</p>
<p><img src="tools/kalivpn.png" alt="Image of VPN connection in Kali Linux" /></p>
<p>You will need the VPN information (host name, port, etc.) from the lab manager. This may come in the form of a file that you import.</p>
<p><em>WARNING: Most VPNs of this sort are classified as SPLIT TUNNEL networks. Only traffic destined for the private network is tunneled. <strong>All other traffic is sent normally.</strong> Be sure that activities like port scanning, vulnerability scanning, endpoint enumeration, etc. are done only on assets that are part of the private network.</em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fundamental-skills"><a class="header" href="#fundamental-skills">Fundamental Skills</a></h1>
<p>We run into a lot of binary data in CTF competitions, reverse engineering, incident response, etc. It's benefical, therefore, to practice common ways of dealing with binary data. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="character-encoding"><a class="header" href="#character-encoding">Character Encoding</a></h1>
<p>In short, character encoding is the mapping between a character and a numerical value that can be stored in memory. Long ago, computers in North America used 7 bits to encode all characters, which provided a usable characterset of 128 different values. Since most computers dealt with 8 bits as a byte, these 7 bits were later extended to 8 bits, or 256 possible combinations. This ASCII standard was used for decades -- at least in North America.</p>
<p>As applications and operating systems were built to support more languages, it became clear that better encoding systems were needed. The UTF-8 and UTF-16 systems have become widely used as ways to encode characters from many different languages. </p>
<p>You should be comfortable with referencing the ASCII and UTF-8 tables to go between characters and values, either in decimal or hexadecimal form. UTF-16 is used in Java and in Windows programming, so it is possible to see that as well. </p>
<p>Bookmark ASCII and UTF-8 tables on your CTF workstation of choice. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="base64-encoding"><a class="header" href="#base64-encoding">Base64 Encoding</a></h1>
<p>Sometimes we need to share binary data with others and one way to do this is in text form. But as we saw in the <em>Character Encoding</em> section, there is a careful mapping between characters and numerical values. </p>
<p>Let's say we want to share a single byte. If that byte has a value between 32 and 126, it would be possible to send the ASCII representaion of the value over plaintext. For example, a byte of value 0x41 could be represented as A. </p>
<p>But what happens to the byte values outside of the printable range? To accomodate for scenarios such as these a binary to text encoding scheme known as Base64 was invented. Every 6 bits of binary data are represented by an 8 bit character. Since 2^6 is 64, we need only part of the typical ASCII character set.</p>
<p>This ratio of 8 bit characters to 6 bit encoding means that, for every 3 bytes of data, we need 4 bytes of characters to encode it.</p>
<p>What happens in the case where the data is not a simple multiple of 6 bits? The values are padded with zeros and the = character appears.</p>
<p>Example: The hex value 0xc0ffee is a 24-bit number. To encode this we will need 32 bits, or 4 characters. </p>
<p>32/6 = 4 bytes need for encoding</p>
<p>0xc0ffee is therefore encoded as wP/u in Base64.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="endianness-little-endian-vs-big-endian"><a class="header" href="#endianness-little-endian-vs-big-endian">Endianness: Little Endian vs. Big Endian</a></h1>
<p>Understanding endianness, or how data is stored in memory, is an important skill to have since we deal with so much in binary form. </p>
<p>In essence, let's look at how a value such as this 32-bit (four byte) integer, 0xdeadbeef, is stored in memory. The two most common ways are:</p>
<div class="table-wrapper"><table><thead><tr><th>Memory Location</th><th>Little Endian System</th><th>Big Endian System</th></tr></thead><tbody>
<tr><td>a</td><td>de</td><td>ef</td></tr>
<tr><td>a+1</td><td>ad</td><td>be</td></tr>
<tr><td>a+2</td><td>be</td><td>ad</td></tr>
<tr><td>a+3</td><td>ef</td><td>de</td></tr>
</tbody></table>
</div>
<p>If you have Ghidra already installed, take a look at <a href="fundamentals/hardcoded">this binary file.</a></p>
<p>If not, then follow along with the analysis. After asking Ghidra to analyze the file, you should see the following code segment that it reversed:</p>
<pre><code>void main(undefined param_1)

{
  undefined4 local_39;
  undefined4 local_35;
  undefined4 local_31;
  undefined2 local_2d;
  undefined4 local_2b;
  undefined4 local_27;
  undefined4 local_23;
  undefined4 local_1f;
  undefined4 local_1b;
  undefined4 local_17;
  undefined3 uStack_13;
  undefined1 *local_10;
  
  local_10 = &amp;param_1;
  local_2b = 0x74696872;
  local_27 = 0x7b465443;
  local_23 = 0x73696874;
  local_1f = 0x5f73695f;
  local_1b = 0x64726168;
  local_17 = 0x65646f63;
  uStack_13 = 0x7d64;
  local_39 = 0x6c6c6548;
  local_35 = 0x6f77206f;
  local_31 = 0x2e646c72;
  local_2d = 10;
  printf(&quot;\n %s&quot;,(char *)&amp;local_39);
  return;
}
</code></pre>
<p>Take a look at the printf() statement near the end. We see the <code>%s</code> and <code>char *</code>, so it's clear that local_39 is an array of characters, aka a string in C. Yet local_39 has a value of <code>0x6c6c6548</code>.  What happens when you place this hexadecimal value into CyberChef and add <em>From Hex</em> to the recipe?</p>
<p><img src="fundamentals/littlechef1.png" alt="cyberchef with From hex" /></p>
<p>I see some characters, but not sure what it means. Let's try some more.</p>
<p><img src="fundamentals/littlechef2.png" alt="cyberchef with From hex" /></p>
<p>More characters. But something doesn't look right.</p>
<p>When we analyzed this file with Ghidra, I noticed that it was a 32-bit ELF executable from a little endian processor. Let's go down that road.</p>
<p>Let's swap the endianness of these bytes. And what's the word length? It's a 32-bit processor, so four bytes per word. Adding the following <em>Swap endianness</em> block to the recipe. Be sure to place it before the <em>From hex</em> block because we want it working on the raw bytes.</p>
<p><img src="fundamentals/swapchef1.png" alt="cyberchef with Swap endian" /></p>
<p>Much better!</p>
<p><img src="fundamentals/swapchef2.png" alt="cyberchef with Swap endian" /></p>
<p>Adding in another word yields:</p>
<p><img src="fundamentals/swapchef3.png" alt="cyberchef with Swap endian" /></p>
<p>And there it is! Our string is in the clear.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="handling-bytes-in-python"><a class="header" href="#handling-bytes-in-python">Handling bytes in Python</a></h1>
<p>Python has two classes for handling byte data -- bytes() and bytearray().</p>
<p>The two classes are similar, but with one crucial difference: bytes() are immutable while bytearray() is mutable.</p>
<p><img src="Python/pythonbytesimmut.png" alt="image of immutable bytes() type" /></p>
<p>Also note the quick shortcut way to create a bytes() object from a string:</p>
<pre><code>your_bytes = b'This string is about to be turned into UTF-8 encoded bytes'
</code></pre>
<p><img src="Python/bstring.png" alt="bstring encoded string literal" /></p>
<p>Which shows that <code>your_bytes</code> is indeed of type bytes() and contains the expected UTF-8 values.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python-xor"><a class="header" href="#python-xor">Python XOR</a></h1>
<p>Exclusive or (XOR) is a <a href="https://en.wikipedia.org/wiki/Exclusive_or">well-known</a> binary logical operator and can be used in Python with the <code>^</code> operator.</p>
<p>For example:</p>
<p><img src="Python/pythonxor.png" alt="xor on bytes()" /></p>
<p>XOR is a fun CTF encryption challenge since two rounds of it returns the plaintext.</p>
<p>Plaintext -- XOR with key --&gt; Ciphertext -- XOR with key --&gt; Plaintext</p>
<p>For XOR'ing long bytes() or bytearray() objects, you can use a for loop or the map function:</p>
<pre><code>def xor(bytes_in, key):
    return bytearray(a^b for a, b in zip(*map(bytearray, [bytes_in, key])))
</code></pre>
<p>This function assumes your key is long enough to align with <code>bytes_in</code>. If need be, extend the key by repeating it over and over until it is long enough before calling this function.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cracking-passwords"><a class="header" href="#cracking-passwords">Cracking passwords</a></h1>
<p>While occasionally we see vendors really screw up and store passwords in plaintext, nearly all passwords are hashed in some form. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cracking-passwords-1"><a class="header" href="#cracking-passwords-1">Cracking passwords</a></h1>
<p>Download a test file here: <a href="passwords/shadow">Example shadow file</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>

    </div>
    </body>
</html>
